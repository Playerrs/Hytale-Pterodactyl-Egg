{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2026-01-13T21:50:54-03:00",
    "name": "Hytale Alpha",
    "author": "josueplayerrs@gmail.com",
    "description": null,
    "features": null,
    "docker_images": {
        "Java 25": "ghcr.io\/ptero-eggs\/yolks:java_25"
    },
    "file_denylist": [],
    "startup": "java -Xms128M -XX:MaxRAMPercentage=95.0 -jar {{SERVER_JAR}} --assets {{GAME_ASSETS}} --bind 0.0.0.0:{{PORT}}",
    "config": {
        "files": "{}",
        "startup": "{\r\n    \"done\": \"Hytale Server Booted\"\r\n}",
        "logs": "{}",
        "stop": "stop"
    },
    "scripts": {
        "installation": {
            "script": "#!\/bin\/bash\r\nset -euo pipefail\r\n\r\necho \"== Hytale Install Script ==\"\r\n\r\nSERVER_DIR=\"\/mnt\/server\"\r\nSTARTUP_SCRIPT=\"start.sh\"\r\nSETTINGS_FILE=\"hytale-settings.txt\"\r\nDOWNLOADER_URL=\"https:\/\/downloader.hytale.com\/hytale-downloader.zip\"\r\nDOWNLOADER_ZIP=\"hytale-downloader.zip\"\r\nDOWNLOADER_BIN=\"hytale-downloader-linux-amd64\"\r\n\r\ncd \"$SERVER_DIR\"\r\n\r\necho \"Updating system and installing dependencies...\"\r\napt-get update\r\napt-get install -y curl unzip jq\r\n\r\n\r\necho \"Downloading Hytale downloader...\"\r\ncurl -fsSL \"$DOWNLOADER_URL\" -o \"$DOWNLOADER_ZIP\"\r\n\r\necho \"Extracting downloader...\"\r\nunzip -o \"$DOWNLOADER_ZIP\"\r\necho \"Removing downloader ZIP...\"\r\nrm -f \"$DOWNLOADER_ZIP\"\r\n\r\nchmod +x \"$DOWNLOADER_BIN\"\r\n\r\n# =========================\r\n# Create hytale-settings.txt\r\n# =========================\r\necho \"Creating $SETTINGS_FILE...\"\r\n\r\ncat > \"$SETTINGS_FILE\" << 'EOF'\r\n# ==========================================\r\n# Hytale Server Settings\r\n# ==========================================\r\n# All HYTALE startup arguments\r\n# are read from this file on every start.\r\n#\r\n# Edit this file to customize your server.\r\n# ==========================================\r\n\r\n--bind 0.0.0.0:5520\r\n--assets Assets.zip\r\nEOF\r\n\r\nchmod 644 \"$SETTINGS_FILE\"\r\n\r\n# =========================\r\n# Create start.sh\r\n# =========================\r\necho \"Creating startup script...\"\r\n\r\ncat > \"$STARTUP_SCRIPT\" << 'EOF'\r\n#!\/bin\/bash\r\nset -euo pipefail\r\n\r\njson_get() {\r\n    echo \"$1\" | sed -n \"s\/.*\\\"$2\\\":\\\"\\([^\\\"]*\\)\\\".*\/\\1\/p\"\r\n}\r\n\r\nSERVER_DIR=\"$(pwd)\"\r\nSETTINGS_FILE=\"hytale-settings.txt\"\r\n\r\nUSER_CONF=\".hytale-user.conf\"\r\nTOKEN_FILE=\".hytale-token.json\"\r\nCLIENT_ID=\"hytale-server\"\r\nSCOPE=\"openid offline auth:server\"\r\n\r\nDOWNLOADER_BIN=\"hytale-downloader-linux-amd64\"\r\nGAME_ZIP=\"game.zip\"\r\nSERVER_FOLDER=\"Server\"\r\n\r\n\r\nlog() {\r\n    echo \"[Hytale] $1\"\r\n}\r\n\r\ncd \"$SERVER_DIR\"\r\n\r\n# =========================\r\n# Download server files if needed\r\n# =========================\r\nif [[ ! -d \"$SERVER_FOLDER\" ]]; then\r\n    log \"Server folder not found. Downloading game files...\"\r\n\r\n    if [[ ! -f \"$DOWNLOADER_BIN\" ]]; then\r\n        log \"ERROR: Downloader binary not found: $DOWNLOADER_BIN\"\r\n        exit 1\r\n    fi\r\n\r\n    chmod +x \"$DOWNLOADER_BIN\"\r\n\r\n    .\/\"$DOWNLOADER_BIN\" -download-path \"$GAME_ZIP\"\r\n\r\n    if [[ ! -f \"$GAME_ZIP\" ]]; then\r\n        log \"ERROR: Game archive was not downloaded.\"\r\n        exit 1\r\n    fi\r\n\r\n    log \"Extracting game files...\"\r\n    unzip -o \"$GAME_ZIP\"\r\n\r\n    log \"Cleaning up downloaded files...\"\r\n    rm -f \"$GAME_ZIP\"\r\n    rm -f hytale-downloader-windows-amd64.exe\r\nelse\r\n    log \"Server folder found. Skipping download.\"\r\nfi\r\n\r\n# =========================\r\n# Load or ask user config\r\n# =========================\r\nif [[ ! -f \"$USER_CONF\" ]]; then\r\n    log \"==================================================\"\r\n    log \"FIRST START CONFIGURATION\"\r\n    log \"Please enter your Hytale Profile UUID:\"\r\n    log \"==================================================\"\r\n\r\n    read -rp \"Hytale Profile UUID: \" PROFILE_UUID\r\n\r\n    if [[ -z \"$PROFILE_UUID\" ]]; then\r\n        log \"ERROR: Profile UUID cannot be empty.\"\r\n        exit 1\r\n    fi\r\n\r\n    cat > \"$USER_CONF\" << EOF2\r\nPROFILE_UUID=\"$PROFILE_UUID\"\r\nEOF2\r\n\r\n    chmod 600 \"$USER_CONF\"\r\n    log \"User configuration saved securely.\"\r\nelse\r\n    # shellcheck disable=SC1090\r\n    source \"$USER_CONF\"\r\nfi\r\n\r\nlog \"Using Profile UUID: $PROFILE_UUID\"\r\n\r\n# =========================\r\n# OAuth Device Flow\r\n# =========================\r\nif [[ ! -f \"$TOKEN_FILE\" ]]; then\r\n    log \"No OAuth tokens found. Starting device authentication...\"\r\n\r\n    DEVICE_RESPONSE=$(curl -s -X POST \\\r\n        \"https:\/\/oauth.accounts.hytale.com\/oauth2\/device\/auth\" \\\r\n        -H \"Content-Type: application\/x-www-form-urlencoded\" \\\r\n        -d \"client_id=$CLIENT_ID\" \\\r\n        -d \"scope=$SCOPE\")\r\n\r\n    \r\n    DEVICE_CODE=$(json_get \"$DEVICE_RESPONSE\" \"device_code\")\r\n    VERIFY_URL=$(json_get \"$DEVICE_RESPONSE\" \"verification_uri_complete\")\r\n    INTERVAL=$(json_get \"$DEVICE_RESPONSE\" \"interval\")\r\n    INTERVAL=${INTERVAL:-5}\r\n\r\n\r\n    if [[ -z \"$DEVICE_CODE\" || \"$DEVICE_CODE\" == \"null\" ]]; then\r\n        log \"ERROR: Failed to obtain device code.\"\r\n        exit 1\r\n    fi\r\n\r\n    log \"==================================================\"\r\n    log \"AUTHENTICATION REQUIRED\"\r\n    log \"Open the following URL in your browser:\"\r\n    log \"$VERIFY_URL\"\r\n    log \"Authorize the application to continue.\"\r\n    log \"==================================================\"\r\n\r\n    while true; do\r\n        sleep \"$INTERVAL\"\r\n\r\n        TOKEN_RESPONSE=$(curl -s -X POST \\\r\n            \"https:\/\/oauth.accounts.hytale.com\/oauth2\/token\" \\\r\n            -H \"Content-Type: application\/x-www-form-urlencoded\" \\\r\n            -d \"client_id=$CLIENT_ID\" \\\r\n            -d \"grant_type=urn:ietf:params:oauth:grant-type:device_code\" \\\r\n            -d \"device_code=$DEVICE_CODE\")\r\n\r\n        ERROR=$(json_get \"$TOKEN_RESPONSE\" \"error\")\r\n\r\n\r\n        if [[ \"$ERROR\" == \"authorization_pending\" ]]; then\r\n            continue\r\n        fi\r\n\r\n        if [[ -n \"$ERROR\" ]]; then\r\n            log \"ERROR during OAuth authentication: $ERROR\"\r\n            exit 1\r\n        fi\r\n\r\n        echo \"$TOKEN_RESPONSE\" > \"$TOKEN_FILE\"\r\n        chmod 600 \"$TOKEN_FILE\"\r\n\r\n        log \"OAuth authentication completed successfully.\"\r\n        break\r\n    done\r\nelse\r\n    log \"OAuth tokens found. Skipping authentication.\"\r\nfi\r\n\r\nACCESS_TOKEN=$(json_get \"$(cat \"$TOKEN_FILE\")\" \"access_token\")\r\n\r\n# =========================\r\n# Create game session\r\n# =========================\r\nSESSION_RESPONSE=$(curl -s -X POST \\\r\n    \"https:\/\/sessions.hytale.com\/game-session\/new\" \\\r\n    -H \"Authorization: Bearer $ACCESS_TOKEN\" \\\r\n    -H \"Content-Type: application\/json\" \\\r\n    -d \"{\\\"uuid\\\":\\\"$PROFILE_UUID\\\"}\")\r\n\r\nSESSION_TOKEN=$(json_get \"$SESSION_RESPONSE\" \"sessionToken\")\r\nIDENTITY_TOKEN=$(json_get \"$SESSION_RESPONSE\" \"identityToken\")\r\n\r\n\r\nif [[ -z \"$SESSION_TOKEN\" || \"$SESSION_TOKEN\" == \"null\" ]]; then\r\n    log \"ERROR: Failed to create game session.\"\r\n    exit 1\r\nfi\r\n\r\nexport HYTALE_SERVER_SESSION_TOKEN=\"$SESSION_TOKEN\"\r\nexport HYTALE_SERVER_IDENTITY_TOKEN=\"$IDENTITY_TOKEN\"\r\n\r\nlog \"Starting Hytale Server...\"\r\n\r\nHYTALE_ARGS=()\r\nwhile IFS= read -r line; do\r\n    [[ -z \"$line\" || \"$line\" =~ ^# ]] && continue\r\n    HYTALE_ARGS+=(\"$line\")\r\ndone < \"$SETTINGS_FILE\"\r\n\r\n\r\nlog \"==================================================\"\r\nlog \"All Hytale Server arguments are loaded from:\"\r\nlog \"  hytale-settings.txt\"\r\nlog \"==================================================\"\r\n\r\nexec java -jar .\/Server\/HytaleServer.jar ${HYTALE_ARGS[@]}\r\nEOF\r\n\r\nchmod +x \"$STARTUP_SCRIPT\"\r\n\r\n\r\necho \"==================================================\"\r\necho \"Install script completed successfully.\"\r\necho \"Startup command must be: .\/start.sh\"\r\necho \"==================================================\"",
            "container": "ghcr.io\/parkervcp\/installers:debian",
            "entrypoint": "bash"
        }
    },
    "variables": []
}